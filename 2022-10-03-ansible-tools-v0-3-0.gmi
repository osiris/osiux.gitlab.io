# *Ansible Tools* `v0.3.0`

* AUTHOR: Osiris Alejandro Gomez
* EMAIL: osiux@osiux.com
* DATE: 2022-10-03 15:06

=> tmb/ansible-tools-v0-3-0.jpg [IMG]
[1]

## *aniversario!* ðŸŽ‚

Hoy ****2022-10-03**** se cumplen exactamente 3 aÃ±os desde el primer *commit* del *repo* `ansible_tools` ^1[2], y me ocupÃ© de versionar una serie de *scripts* que tenÃ­a dando vueltas para aprovechar la ocasiÃ³n :)

## *todo comenzÃ³ algÃºn tiempo atrÃ¡s...*

Viendo el historial recordÃ© cÃ³mo fue que todo comenzÃ³, bÃ¡sicamente estaba lidiando con la molesta tarea de actualizar la `version` de cada *rol* en el archivo `requirements.yml` de un gran *playbook* de `ansible` ^2[3], y como eran demasiados `roles` cada uno en en un repositorio diferente, era muy engorroso estar viendo cuÃ¡l era el Ãºltimo *release* y realizar el cambio.

## `v0.1.0 requirements-version-update`[4]

Si definimos como tarea *"actualizar la versiÃ³n de cada rol al Ãºltimo tag disponible"* es algo que se puede automatizar fÃ¡cilmente. BastÃ³ con dividir la tarea en 2 para rÃ¡pidamente obtener un resultado exitoso.

Primero generÃ© `git-ls-remote-tags` que no hace otra cosa que listar los `tags` del repositorio actual de forma cronolÃ³gica de modo que al quedarse con el primer resultado, obtenemos el Ãºltimo *tag*.

Luego fue simplemente leer el *YAML* e ir reescribiÃ©ndolo con lo mismo pero reemplazando `version` con el Ãºltimo *tag*.

Y este *script* no solo permitiÃ³ ahorrar tiempo, lo mejor fue ahorrar dolores de cabeza, luego con una revisiÃ³n manual bastaba para ajustar alguna dependencia en particular (no siempre se desea la Ãºltima versiÃ³n).

## `v0.1.1 - v0.1.6` *parches y mejoras*[5]

Hubo pequeÃ±as mejoras y parches, aunque apareciÃ³ otra necesidad, la de reescribir el origen de cada repositorio, bÃ¡sicamente convertir un *repo* `ssh` a una *url* `https`, y esto fue necesario para clonar repositorios en una red sin acceso por *SSH*.

## `v0.1.7` *envolviendo `awx-cli`*[6]

Si bien el `cli` de *AWX* ^3[7] es muy completo, me vi con la necesidad de extender ciertas funcionalidades, mayormente agregar validaciones y automatizar algunas tareas repetitivas de `ad-hoc`, asignaciones de permisos, obtener valores de variables de *hosts* e *inventories* y comenzar a recibir y enviar un *job~template~* de un entorno a otro.

## `v0.1.8` *encerar y pulir*[8]

Variedad de *scripts* pero mayormente hay cierta cosmÃ©tica general, se comienzan a unificar criterios y muchas mejoras gracias a las sugerencias de `shellcheck` ^4[9].

## `v0.2.0` *happy gnu year*[10]

Aprovecho el aÃ±o nuevo para comenzar versionando para la posteridad una serie de mejoras y nuevas funcionalidades para que no se pierdan al irme de vacaciones `XD`

## `v0.3.0` *automated deploy*[11]

La mayor novedad es la posibilidad de generar un *deploy* desatendido del repositorio `awx` donde estÃ¡n todos los recursos en forma de `.json`, basta con ejecutar `awx-deploy-revision` (con mÃ­nimas opciones) y este *script* se ocupa de todo :)

Relacionado al *deploy=* ahora se puede generar un sumario de los `releases` en base a los *tags* y tambiÃ©n se agregan varias utilidades para obtener y actualizar variables de archivos *YAML* y algunas para realizar comparaciones de variables entre diferentes *groups* de un mismo *inventory*, esto resultÃ³ muy Ãºtil para unificar valores y mejorar la precedencia.

Otros comandos Ãºtiles permiten lidiar con las diferentes formas de escribir una variable `vault`

CreaciÃ³n y modificaciÃ³n de credenciales `ssh` cifradas desde un repositorio `pass` o desde archivos en el directorio `~/.ssh/`.

## *mejora continua*

Hace 3 aÃ±os no hubiese imaginado que las `ansible tools` se iban a convertir en mas de 270 *scripts* de uso diario y que hoy las considero indispensables para interacturar con *GitLab* y *AWX*.

Seguramente, irÃ¡n mejorando y en algÃºn momento habrÃ¡ que dar el salto a nuevas versiones de *AWX* y nuevas integraciones.

=> file:img/2022-10-03-ansible-tools-v0-3-0.jpg 1: file:img/2022-10-03-ansible-tools-v0-3-0.jpg
=> https://gitlab.com/gcoop-libre/ansible_tools 2: https://gitlab.com/gcoop-libre/ansible_tools
=> https://www.ansible.com/ 3: https://www.ansible.com/
=> https://gitlab.com/gcoop-libre/ansible_tools/-/commit/bd38875 4: https://gitlab.com/gcoop-libre/ansible_tools/-/commit/bd38875
=> https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.1...v0.1.6 5: https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.1...v0.1.6
=> https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.6...v0.1.7 6: https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.6...v0.1.7
=> https://github.com/ansible/awx/ 7: https://github.com/ansible/awx/
=> https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.7...v0.1.8 8: https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.7...v0.1.8
=> https://github.com/koalaman/shellcheck 9: https://github.com/koalaman/shellcheck
=> https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.8...v0.2.0 10: https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.1.8...v0.2.0
=> https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.2.0...v0.3.0 11: https://gitlab.com/gcoop-libre/ansible_tools/-/compare/v0.2.0...v0.3.0